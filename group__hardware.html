<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SiPM Calibration Control Program: Hardware Interface</title>
<!-- Overriding the tabs css with our own -->
<!--link href="tabs.css" rel="stylesheet" type="text/css"/-->
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--Explicitly calling the including the stuff required for search-->
<!--<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
-->
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" />
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SiPM Calibration Control Program
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle"><div class="title">Hardware Interface</div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >The control and manipulation of hardware interfaces is typically implemented in C/C++, then exposed to python via <code>pybind11</code>. The choice of using C/C++ is to allow for some time critical processes to run (such as the fast pulse required for the data collection trigger), while keep the library requirements to a minimal. The <code>pybind11</code> related files used to expose the interfaces to python will be separated into the <code>cmod</code> directory with the other low level python interfaces.</p>
<h2>General design philosophy</h2>
<p >For the various interfaces, we expect that there will be issues with the certain interface not existing, either because the system is in a non-standard configuration for testing, or the system in question is some personal machine used for local testing. In such a case, the program in question should <b>raise exceptions</b> during the <em>initialization</em> phase, and should raise an exception when if the user tries to use the interface regardless. This allows for the user to test the various functionalities of the system, even when certain interfaces are not available or not connected.</p>
<p >As the <code>pybind11</code> section of the code is separated out into a separate directory. All interfaces should have their dedicated header file. The documentation within the header file should be kept to a minimum, with the detailed explanations placed next to the various functions. We will intentionally choose a different format compared with python, with both functions and class names in the <code>CamelCase</code> format.</p>
<h2>Overview of technology for various interfaces</h2>
<p >Here we go over the technology used in the various interface, as well as independent design philosophies used for the various interfaces. All libraries are compiled using <a href="https://pybind11.readthedocs.io/en/stable/">pybind11</a> for exposure to python interface.</p>
<h3><a class="el" href="classGPIO.html" title="Interface to the GPIO hardware interfaces.">GPIO</a> interface for ADC, PWM and raw trigger control</h3>
<ul>
<li>Files: <a href="gpio.cc">gpio.cc</a>, <a href="gpio.hpp">gpio.hpp</a></li>
<li>Main documentation: <a class="el" href="classGPIO.html">GPIO</a></li>
</ul>
<p >Controls to the <a class="el" href="classGPIO.html" title="Interface to the GPIO hardware interfaces.">GPIO</a> interface uses raw <code>sysfs</code> interfaces to reduce external library dependencies, and to allow for fast switching for raw trigger controls (trigger can fire as fast a new nanosecond with a period of 1 microsecond). External documentations of the various systems used:</p>
<ul>
<li>For references of raw gpio controls (trigger and switches), see the <a href="https://elinux.org/GPIO">linux kernel documentation</a>.</li>
<li>For references of PWM related controls, see <a href="https://jumpnowtek.com/rpi/Using-the-Raspberry-Pi-Hardware-PWM-timers.html">here</a></li>
<li>For references of ADS1115s ADC det controls via i2c see <a href="http://www.bristolwatch.com/rpi/ads1115.html">here</a></li>
<li>For additional PIN reference of the Raspberry Pi, look at the outputs of the <a href="http://wiringpi.com/">wiring-pi</a> library.</li>
</ul>
<h3><a class="el" href="classVisual.html" title="Visual system interface class.">Visual</a> interface for visual processing</h3>
<ul>
<li>Files: <a href="visual.cc">visual.cc</a>, <a href="visual.hpp">visual.hpp</a></li>
<li>Main documentation: <a class="el" href="classVisual.html">Visual</a></li>
</ul>
<p >We are using OpenCV to process the inputs of a video stream to find a detector element. It uses a relatively simple contouring algorithm and dark square finding algorithm define the photodetector position. Details of the implementation are documented in the function itself.</p>
<h3>Picoscope interface for SiPM data collection</h3>
<ul>
<li>Files: <a href="pico.cc">pico.cc</a>, <a href="pico.hpp">pico.hpp</a></li>
<li>Main documentation: <a class="el" href="classPicoUnit.html">PicoUnit</a></li>
</ul>
<p >We are using the C++ interface provided by Pico Technology. Essentially we are compartment the relevant code in the given reference main function to fit our needs. The reference code can be found in the open source part of the part of the <a href="https://github.com/picotech/picosdk-c-examples">picoscope reference software</a>. Notice that the picoscope requires proprietary drivers from PicoTechnology, you can find how to install it in the <a class="el" href="md_install.html#install">install instructions</a></p>
<h3>DRS4 interfacoe for high resolution SiPM data collection</h3>
<ul>
<li>Files: <a href="drs.cc">drs.cc</a>, <a href="drs.hpp">drs.hpp</a></li>
<li>Main documentation: <a class="el" href="classDRSContainer.html">DRSContainer</a></li>
</ul>
<p >Similar to the picoscope, we are exposing the C-interface of the DRS4, as well as abstracting various control flows commonly used by the system into single high-level functions. The reference for the code can be found in the open source <a href="https://www.psi.ch/en/drs/software-download">reference code</a>. The nice thing about the DRS4 from a software point of view is that it is effectively driverless, using only the USB drivers already in place in most UNIX systems. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__Logging"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Logging.html">Logging</a></td></tr>
<tr class="memdesc:group__Logging"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exposing python logging facilities to low level C++ modules. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcmod_1_1TBController_1_1TBController.html">cmod.TBController.TBController</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object for interacting with the Tileboard controller.  <a href="classcmod_1_1TBController_1_1TBController.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcmod_1_1TBController_1_1I2CController.html">cmod.TBController.I2CController</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specialized <a class="el" href="classcmod_1_1TBController_1_1ZMQController.html" title="Common ZQM client class.">ZMQController</a> class for I2C slow controls.  <a href="classcmod_1_1TBController_1_1I2CController.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcmod_1_1TBController_1_1DAQController.html">cmod.TBController.DAQController</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specialization for the fast control and readout socket instances.  <a href="classcmod_1_1TBController_1_1DAQController.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRSContainer.html">DRSContainer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling interfacing between the DRS readout system.  <a href="classDRSContainer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGCoder.html">GCoder</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling the transmission of gcode motion commands.  <a href="classGCoder.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGPIO.html">GPIO</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface to the <a class="el" href="classGPIO.html" title="Interface to the GPIO hardware interfaces.">GPIO</a> hardware interfaces.  <a href="classGPIO.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPicoUnit.html">PicoUnit</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for the picotech PICOSCOPE for data collection.  <a href="classPicoUnit.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVisual.html">Visual</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classVisual.html" title="Visual system interface class.">Visual</a> system interface class.  <a href="classVisual.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/>
  <address class="footer">
    <small>
    Generated by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.9.5
    </small>
  </address>
  <address class="footer">
    <small>
    Source code hosted on<a href="http://github.com">GitHub</a>
    </small>
  </address>
  <address class="footer">
    <small id="debugger">
    Debug:
    </small>
  </address>
<!-- custom Javascript stuff -->
  <script type="text/javascript" src="customjs/summary.js"></script>
</body>
</html>
