<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SiPM Calibration Control Program: SiPM Calibration Control Program</title>
<!-- Overriding the tabs css with our own -->
<!--link href="tabs.css" rel="stylesheet" type="text/css"/-->
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<!--Explicitly calling the including the stuff required for search-->
<!--<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
-->
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" />
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SiPM Calibration Control Program
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">SiPM Calibration Control Program </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_mainpage"></a> This official documentation of the SiPM calibaration control program. This documentation covers both the user-level manual and the software design aspects. The official code is hosted on <a href="https://github.com/UMDCMS/SiPMCalibControl">GitHub</a>, the analysis of the data collected by this package is performed by a separate software package that can be found <a href="https://github.com/UMDCMS/SiPMCalib">here</a>.</p>
<h2>General start-up instructions for system users</h2>
<p>For security reasons, the details for connecting to the various machines will not be listed in this manual, and should ask the system administrators if there are connection issues. There are two UNIX-like machines in the system and the user is responsible to making sure they are using the correct commands on the correct machine. The instructions works only after <a class="el" href="install.html">installation</a> of the various system permissions.</p>
<h3>Power on</h3>
<p>Power on all low voltage systems required for gantry calibrations, this includes:</p>
<ul>
<li>The control Raspberry Pi.</li>
<li>The 5V power distribution board.</li>
<li>The tileboard controller (the tileboard receives power through the tileboard controller.)</li>
<li>The analog pulse generator.</li>
<li>The Picoscope digital oscilloscope (optional).</li>
<li>The DRS4 digital oscilloscope (optional).</li>
<li>Additional monitoring scope outside the main dark room (optional).</li>
</ul>
<p>At this stage, do <em>not</em> turn on the high voltage power supply at this point in time, as this can potentially damage the SiPMs by exposing them to high intensity background light.</p>
<h3>Permission checks and service start-up</h3>
<p>Log into the control Raspberry Pi (contact administrators for how to do this), and make sure you are on an account with the permission to the key control devices.</p>
<div class="fragment"><div class="line">[user@rpi]$ groups</div>
<div class="line">drs pico i2c gpio video # Output should contain at least these 5 groups.</div>
</div><!-- fragment --><p>After this, log into the tileboard controller (again, contact administrators for how to do this), and start the relevant services using the following 2 commands:</p>
<div class="fragment"><div class="line">[user@TBController]$ $HOME/scripts/startup.sh</div>
<div class="line">[user@TBController]$ $HOME/scripts/serverup.sh</div>
</div><!-- fragment --><p>The first script would prompt you for a password, while the second script should be complete without any outputs. Notice the second script starts the services in the background and should not be executed a second time. If you are unsure whether the services are already running, run the following commands:</p>
<div class="fragment"><div class="line">[user@TBController]$ ps aux | grep zmq_server | grep -v grep</div>
<div class="line">[user@TBController]$ ps aux | grep zmq-server | grep -v grep</div>
<div class="line">[user@TBController]$ ps aux | grep zmq-client | grep -v grep</div>
</div><!-- fragment --><p>Each command should have a single line for a nominally running service that looks something like:</p>
<div class="fragment"><div class="line">HGCAL_d+  5023  9.9 22.6 876196 462852 ?       Sl   Nov17 569:46 /opt/hexactrl/ROCv2/bin/zmq-server</div>
</div><!-- fragment --><p>If you wish to terminate the existing services and restart the services, you can run the following scripts:</p>
<div class="fragment"><div class="line">[user@TBController]$ $HOME/scripts/serverup.sh</div>
<div class="line">[user@TBController]$ $HOME/scripts/serverdown.sh</div>
</div><!-- fragment --><h3>Starting the calibration control program</h3>
<p>After the system power on and making sure all required services have been properly started. You can start 1 of the 2 control programs:</p>
<ul>
<li>The <a class="el" href="group__cli.html">command line interface</a>. This is mainly for the development of calibration sequences, individual subsystem controls schemes as well for debugging potential issues (or if you are simply more comfortable with a CLI interface). The main manual for using the CLI interface can be found at <a class="el" href="group__cli.html">here</a>. If you are attempting to develop a certain calibration sequence, be sure to also console the <a class="el" href="group__cli__design.html">CLI design</a> pages for more detailed information on how to do so. You can start a CLI control program instance using the following commands on the control Raspberry Pi:</li>
</ul>
<div class="fragment"><div class="line">[user@RPi]$ cd $HOME/SiPMCalibControl/</div>
<div class="line">[user@RPi]$ DEVICES=1 ./deploy.sh # This will spawn a docker session</div>
<div class="line">[root@&lt;hash&gt;]$ python3 control.py</div>
</div><!-- fragment --><ul>
<li>The graphical user interface(currently under constructions): This interface is mainly for batch processing of SiPM calibration during production, with additional niceties such as on-the-fly plotting for rudimentary data quality management and other progress visualization tools. You can start the GUI control program by running the Raspberry Pi, then use your favorite web browser to go to the URL: <code>&lt;RPi.ip.address&gt;:9100</code>.</li>
</ul>
<div class="fragment"><div class="line">[user@RPi]$ cd $HOME/SiPMCalibControl</div>
<div class="line">[user@RPi]$ DEVICES=1 ./deploy.sh # This will spawn a docker session</div>
<div class="line">[root@&lt;hash&gt;]$ python3 gui_control.py</div>
</div><!-- fragment --><h2>Development instructions</h2>
<p>For developers, these following pages aim to highlight the main design and development philosophies used for the various systems. Due to how the Doxygen preferring to generate docs pages of individual objects into a single page, which costs more clicks, developers might want to use these pages as a starting point, and browse the documentations in the various doc strings and comments directly.</p>
<ul>
<li>CLI interface objects and design main reference can be found on this page <a class="el" href="group__cli__design.html">here</a>.</li>
<li>GUI interface server/client model as well as additional references can be found on this page</li>
<li>The implementation of various hardware interfaces can be found on this <a class="el" href="group__hardware.html">page</a></li>
<li>The installation of the main program, as well the installation for the various external components can be found <a class="el" href="install.html">here</a>. </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/>
  <address class="footer">
    <small>
    Generated by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.10.0
    </small>
  </address>
  <address class="footer">
    <small>
    Source code hosted on<a href="http://github.com">GitHub</a>
    </small>
  </address>
  <address class="footer">
    <small id="debugger">
    Debug:
    </small>
  </address>
<!-- custom Javascript stuff -->
  <script type="text/javascript" src="customjs/summary.js"></script>
</body>
</html>
